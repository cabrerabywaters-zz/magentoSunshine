<?php
$storeId = $this->getStoreId();
$date    = Mage::getSingleton('core/date')->gmtDate('Y-m-d');

$baseUrl = Mage::app()->getStore($storeId)->getBaseUrl(Mage_Core_Model_Store::URL_TYPE_LINK);
$postcollection = Mage::getModel('blogmate/blog')->getCollection()
			    ->addFieldToFilter('status',array('eq'=>'1'));
			    
echo '<?xml version="1.0" encoding="UTF-8"?>' . "\n"; 
echo '<rss version="2.0">';
echo "<channel>";
//echo "<title></title><link></link><description></description><pubDate></pubDate><language>en-us</language>";
foreach ($postcollection as $postitem) { 
  $title = $postitem['title'];
  $link = $baseUrl.$postitem['title_slug'];
 $shortDescription = $postitem['short_description'];
$texthtml2 = $postitem['blog_content'];
                                preg_match('/<img[^>]+src="{{media url="([^">]+)"/', $texthtml2, $image);
$imageUrl= Mage::getBaseUrl('media') . $image[1];
  $pubDate = $postitem['created_at']; 
    $pubDate1= date("D, d M Y H:i:s T", strtotime($pubDate));
  echo "<item>
	  <title>$title</title>
	  <link>$link</link>
	  <description>$shortDescription</description>
<pubDate>$pubDate1</pubDate>
<image>
    <url>$imageUrl</url>
    <link>$title</link>
  </image>


      </item>";
}
echo "</channel></rss>";
echo '<!-- XML Feed generated by Magik Blogmate -->';

?> 

